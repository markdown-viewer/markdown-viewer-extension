# 表格合并功能测试 / Table Merge Demo

此文档用于测试空单元格自动向上合并功能。

**智能合并策略：**
- 仅对树形结构表格进行合并
- 备注列、比较表、稀疏表不会错误合并
- 分组标题行作为合并边界

---

## 1. 基础树形合并

| 姓名 | 部门   | 职位   |
|------|--------|--------|
| 张三 | 技术部 | 工程师 |
|      |        | 架构师 |
| 李四 | 市场部 | 经理   |

**预期效果：**
- "张三" 向下合并 2 行
- "技术部" 向下合并 2 行

---

## 2. 多层级树形结构

| 部门   | 团队     | 成员   | 职责         |
|--------|----------|--------|--------------|
| 研发部 | 前端组   | 王小明 | React 开发   |
|        |          | 李小红 | Vue 开发     |
|        |          |        | 代码审查     |
|        | 后端组   | 张小刚 | Java 开发    |
|        |          | 赵小丽 | Python 开发  |
| 产品部 | 产品组   | 钱小伟 | 需求分析     |
|        |          |        | 原型设计     |

**预期效果：**
- "研发部" 合并 5 行，"产品部" 合并 2 行
- "前端组" 合并 3 行，"后端组" 合并 2 行
- "李小红" 合并 2 行，"钱小伟" 合并 2 行

---

## 3. 带分组标题的树形表格（混合模式）

| 分类     | 子类   | 项目   | 数量 |
|----------|--------|--------|------|
| 【水果】 |        |        |      |
| 热带     | 芒果   | 大芒果 | 10   |
|          |        | 小芒果 | 20   |
|          | 香蕉   | 皇帝蕉 | 15   |
| 【蔬菜】 |        |        |      |
| 叶菜     | 白菜   | 大白菜 | 30   |
|          |        | 小白菜 | 25   |

**预期效果：**
- "【水果】"和"【蔬菜】"是分组标题，**不参与合并**
- "热带"合并到"香蕉"行
- 每个分组内的树形结构正常合并

---

## 4. 备注列表格（不应合并）

| 项目   | 状态   | 备注             |
|--------|--------|------------------|
| 任务A  | 完成   | 已验收           |
| 任务B  | 进行中 |                  |
| 任务C  | 完成   | 需要复核         |
| 任务D  | 待定   |                  |
| 任务E  | 完成   | 提前完成         |

**预期效果：** 备注列空白是正常的稀疏数据，**不应合并**

---

## 5. 功能对比表（不应合并）

| 功能     | 基础版 | 专业版 | 企业版 |
|----------|--------|--------|--------|
| 用户数   | 1      | 10     | 无限   |
| 存储空间 | 1GB    | 10GB   | 100GB  |
| API 访问 | ✗      | ✓      | ✓      |
| 高级分析 | ✗      | ✗      | ✓      |
| 专属支持 |        | ✓      | ✓      |

**预期效果：** 这是功能对比表，空单元格表示"无此功能"，**不应合并**

---

## 6. 时间表/日程表（不应合并）

| 时间      | 周一   | 周二   | 周三   | 周四   | 周五   |
|-----------|--------|--------|--------|--------|--------|
| 09:00     | 会议   |        | 培训   |        | 总结   |
| 10:00     |        | 开发   |        | 测试   |        |
| 14:00     | 评审   |        |        |        | 发布   |
| 16:00     |        | 讨论   |        | 演示   |        |

**预期效果：** 日程表的空白表示空闲时段，**不应合并**

---

## 7. 文件系统树

| 目录     | 子目录   | 文件         | 大小   |
|----------|----------|--------------|--------|
| /home    | user     | .bashrc      | 1KB    |
|          |          | .profile     | 0.5KB  |
|          | projects | README.md    | 2KB    |
|          |          | package.json | 1KB    |
| /etc     | nginx    | nginx.conf   | 4KB    |
|          |          | mime.types   | 10KB   |

**预期效果：**
- "/home" 合并 4 行
- "user" 合并 2 行，"projects" 合并 2 行
- "/etc" 和 "nginx" 各合并 2 行

---

## 8. 组织架构表

| 公司     | 部门   | 小组   | 员工   |
|----------|--------|--------|--------|
| ABC 集团 | 技术部 | 开发组 | 张三   |
|          |        |        | 李四   |
|          |        | 测试组 | 王五   |
|          | 行政部 | 人事组 | 赵六   |
|          |        |        | 钱七   |
| XYZ 公司 | 销售部 | 国内组 | 孙八   |
|          |        | 海外组 | 周九   |

**预期效果：**
- "ABC 集团" 合并 5 行，"XYZ 公司" 合并 2 行
- 各级部门和小组按层级合并

---

## 9. 账目分类表（带分组标题）

| 类目       | 明细     | 金额   |
|------------|----------|--------|
| ═收入═     |          |        |
| 销售收入   | 产品A    | 10000  |
|            | 产品B    | 8000   |
| 服务收入   | 咨询     | 5000   |
| ═支出═     |          |        |
| 人工成本   | 工资     | 15000  |
|            | 社保     | 3000   |
| 运营成本   | 房租     | 5000   |
|            | 水电     | 1000   |

**预期效果：**
- "═收入═"和"═支出═"是分组标题，作为合并边界
- 每个分组内的项目正常合并

---

## 10. 产品目录（深层树形）

| 一级分类 | 二级分类 | 三级分类 | 产品   | 价格 |
|----------|----------|----------|--------|------|
| 电子产品 | 手机     | 智能机   | iPhone | 6999 |
|          |          |          | 三星   | 5999 |
|          |          | 功能机   | 诺基亚 | 299  |
|          | 电脑     | 笔记本   | MacBook| 9999 |
|          |          |          | ThinkPad| 6999|
|          |          | 台式机   | iMac   | 12999|
| 服装     | 男装     | 上衣     | T恤    | 99   |
|          |          |          | 衬衫   | 199  |

**预期效果：** 4 级树形结构，左侧列按层级合并，价格列保持独立

---

## 11. 全空数据行测试

| Name | Value |
|------|-------|
| A    | 100   |
|      |       |
|      |       |
| B    | 200   |

**预期效果：**
- Name 列：A 合并 3 行，B 独立
- Value 列：100 合并 3 行，200 独立

---

## 12. 无需合并的简单表格

| 水果   | 颜色 | 价格 |
|--------|------|------|
| 苹果   | 红色 | 5元  |
| 香蕉   | 黄色 | 3元  |
| 葡萄   | 紫色 | 8元  |

**预期效果：** 无任何合并，保持原样

---

## 13. 调查问卷结果（稀疏表，不应合并）

| 问题   | 选项A | 选项B | 选项C |
|--------|-------|-------|-------|
| 问题1  | 30%   |       | 70%   |
| 问题2  | 50%   | 25%   |       |
| 问题3  |       | 60%   | 40%   |
| 问题4  | 45%   |       | 55%   |

**预期效果：** 空白表示该选项无人选择，**不应合并**

---

## 14. 混合：分组标题 + 比较符号

| 模块     | 功能A | 功能B | 功能C |
|----------|-------|-------|-------|
| 【基础】 |       |       |       |
| 登录     | ✓     | ✓     | ✓     |
| 注册     | ✓     | ✓     |       |
| 【高级】 |       |       |       |
| 报表     |       | ✓     | ✓     |
| 分析     |       |       | ✓     |

**预期效果：** 
- 检测为比较表，不应合并功能列
- 分组标题行可以被识别

---

## 15. 带对齐的表格

| 左对齐 | 居中对齐 | 右对齐 |
|:-------|:--------:|-------:|
| A      | B        | C      |
|        |          |        |
| D      | E        | F      |

**预期效果：**
- 所有列的对齐方式应保持不变
- 如果被识别为树形，A、B、C 各合并 2 行

---

## 16. 树形结构 + 备注列

| 部门   | 团队   | 成员   | 备注           |
|--------|--------|--------|----------------|
| 技术部 | 前端组 | 张三   | 组长           |
|        |        | 李四   |                |
|        |        | 王五   | 实习生         |
|        | 后端组 | 赵六   |                |
|        |        | 钱七   | 架构师         |
| 市场部 | 销售组 | 孙八   | 区域经理       |
|        |        | 周九   |                |

**预期效果：**
- 前 3 列是树形结构，正常合并
- 备注列是稀疏数据，**不应合并**（空白表示无特殊备注）

---

## 17. 树形 + 可选字段列

| 分类   | 子类   | 产品   | 价格 | 促销价 | 库存备注 |
|--------|--------|--------|------|--------|----------|
| 电子   | 手机   | iPhone | 6999 |        | 热销     |
|        |        | 小米   | 2999 | 2499   |          |
|        | 平板   | iPad   | 3999 |        |          |
|        |        | 华为   | 2999 | 2799   | 新品     |
| 服装   | 男装   | T恤    | 99   | 79     |          |
|        |        | 衬衫   | 199  |        | 缺货     |

**预期效果：**
- 分类、子类、产品列是树形，正常合并
- 价格列每行都有值，不合并
- 促销价和库存备注是可选字段，**不应合并**

---

## 18. 深层树形 + 末尾备注

| 一级   | 二级   | 三级   | 四级   | 说明             |
|--------|--------|--------|--------|------------------|
| A      | A1     | A1a    | Item1  | 首选             |
|        |        |        | Item2  |                  |
|        |        | A1b    | Item3  |                  |
|        | A2     | A2a    | Item4  | 备选方案         |
|        |        |        | Item5  |                  |
| B      | B1     | B1a    | Item6  |                  |
|        |        |        | Item7  | 待确认           |

**预期效果：**
- 前 4 列树形结构完整合并
- 说明列空白是正常的，**不应合并**

---

## 19. 组织架构 + 联系方式备注

| 公司     | 部门   | 职位   | 姓名   | 分机 | 备注       |
|----------|--------|--------|--------|------|------------|
| 总公司   | 行政部 | 经理   | 张总   | 8001 | 周一休     |
|          |        | 助理   | 小李   | 8002 |            |
|          | 技术部 | 总监   | 王工   | 8101 |            |
|          |        | 开发   | 小陈   | 8102 | 远程办公   |
|          |        |        | 小刘   | 8103 |            |
| 分公司   | 销售部 | 主管   | 赵经理 | 9001 |            |
|          |        | 销售   | 小孙   | 9002 | 出差中     |

**预期效果：**
- 公司、部门、职位、姓名是树形结构，正常合并
- 分机每行都有，不合并
- 备注列是可选信息，**不应合并**
